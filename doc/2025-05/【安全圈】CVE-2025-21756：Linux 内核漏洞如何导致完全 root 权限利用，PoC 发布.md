#  【安全圈】CVE-2025-21756：Linux 内核漏洞如何导致完全 root 权限利用，PoC 发布   
 安全圈   2025-05-06 11:03  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/aBHpjnrGylgOvEXHviaXu1fO2nLov9bZ055v7s8F6w1DD1I0bx2h3zaOx0Mibd5CngBwwj2nTeEbupw7xpBsx27Q/640?wx_fmt=other&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
  
**关键词**  
  
  
  
Linux  
  
  
![根 Linux](https://mmbiz.qpic.cn/sz_mmbiz_jpg/aBHpjnrGylgY6eeZKvCDeL2Xbs1JicUaYkzHGF7zyKzibZqc8OkicU6ZNOsWOjO3iaiadk9vT5lcYDyyHIUklCxwHLw/640?wx_fmt=other&from=appmsg "")  
  
在最近的分析中，安全研究员 Michael Hoefler 揭露了 CVE-2025-21756 的完整细节，这是一个影响 Linux 内核 vsock 子系统的释放后使用 (UAF) 漏洞。最初只是简单的代码调整——修改了几行 vsock_remove_sock() 的行为——最终阻止了一条通往本地特权提升 (LPE) 和内核代码执行的复杂路径。  
  
“当内核中某个对象的引用计数器达到零时，该对象将被释放到其各自的内存管理器。理想情况下，在释放 vsock 对象后，我们将能够触发某种释放后使用 (UAF) 漏洞，以获得更好的原始权限并提升权限  
，”Hoefler  
解释道  
。  
  
该  
漏洞  
源于传输重新分配期间对套接字绑定状态的处理不当。具体而言，vsock 代码错误地减少了已解除绑定套接字的引用计数器，导致 vsock 对象过早释放。  
  
  
补丁分析指出： “传输重新分配可以触发 vsock_remove_sock，它会调用 vsock_remove_bound，从而错误地减少 vsock 对象上的引用计数器  
。”这引入了一种危险的 UAF 条件，攻击者可以利用该条件来获取强大的  
利用  
原语。  
  
最初的利用尝试导致了内核崩溃，表明 AppArmor — 通过 Linux 安全模块 (LSM) 挂钩 — 在释放套接字时消除了 sk_security 指针，从而阻止了直接函数指针损坏。  
  
Hoefler 强调说： “内核授予我们一个指向套接字的悬空指针 — — 但 AppArmor 确保我们在用它做任何有用的事情之前崩溃  
。”因此，攻击者必须找到不受 AppArmor 保护的内核函数才能继续  
利用  
。  
  
为了绕过内核地址空间布局随机化 (kASLR) 而不依赖受 AppArmor 保护的函数，Hoefler 转向了 vsock_diag_dump() 功能，这是一个不受保护的 netlink 诊断工具。  
  
通过使用精心设计的管道缓冲区回收释放的 vsock 套接字并利用 vsock_diag_dump 作为侧信道，Hoefler 暴力破解了有效的 skc_net 指针，从而绕过了 kASLR。  
  
“我陷入了困境，于是求助于 kernelctf 社区，@h0mbre 建议使用 vsock_diag_dump 作为侧信道来暴力破解 skc_net 指针  
，”Hoefler 回忆道。这允许我通过已知的内存偏移量完全控制悬空套接字对象。  
  
为了获得代码执行权限，Hoefler 利用了 vsock_release() 函数。由于该函数未受到 AppArmor 的保护，攻击可以劫持 sk->sk_prot->close 函数指针，并转向 ROP（面向返回编程）链：  
  
“我们最感兴趣的是对 sk->sk_prot->close(sk, 0) 的调用。由于我们控制 sk，所以我们需要一个指向函数的有效指针  
，”他解释道。  
  
最后的 ROP 链调用 commit_creds(init_cred)，授予攻击者 root 权限并干净地将执行返回到用户空间。  
  
  
来源：  
https://securityonline.info/cve-2025-21756-how-a-tiny-linux-kernel-bug-led-to-a-full-root-exploit-poc-releases/  
  
  
  END    
  
  
阅读推荐  
  
  
[【安全圈】某机关工作人员用扫描APP加网盘致127份涉密文件遭泄露！！](https://mp.weixin.qq.com/s?__biz=MzIzMzE4NDU1OQ==&mid=2652069446&idx=1&sn=cdb886ad48aa07b1291c56c13b3a291e&scene=21#wechat_redirect)  
  
  
  
[【安全圈】微软Telnet服务器被曝0-Click漏洞：无密码即可控制系统](https://mp.weixin.qq.com/s?__biz=MzIzMzE4NDU1OQ==&mid=2652069446&idx=2&sn=b093a02905ad8999ac398713a11bd267&scene=21#wechat_redirect)  
  
  
  
[【安全圈】网安公司CEO因非法控制医院电脑被逮捕](https://mp.weixin.qq.com/s?__biz=MzIzMzE4NDU1OQ==&mid=2652069446&idx=3&sn=71724284d0e78496375f89e77e21a8b6&scene=21#wechat_redirect)  
  
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/aBHpjnrGylgeVsVlL5y1RPJfUdozNyCEft6M27yliapIdNjlcdMaZ4UR4XxnQprGlCg8NH2Hz5Oib5aPIOiaqUicDQ/640?wx_fmt=gif "")  
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/aBHpjnrGylgeVsVlL5y1RPJfUdozNyCEDQIyPYpjfp0XDaaKjeaU6YdFae1iagIvFmFb4djeiahnUy2jBnxkMbaw/640?wx_fmt=png "")  
  
**安全圈**  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/aBHpjnrGylgeVsVlL5y1RPJfUdozNyCEft6M27yliapIdNjlcdMaZ4UR4XxnQprGlCg8NH2Hz5Oib5aPIOiaqUicDQ/640?wx_fmt=gif "")  
  
  
←扫码关注我们  
  
**网罗圈内热点 专注网络安全**  
  
**实时资讯一手掌握！**  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/aBHpjnrGylgeVsVlL5y1RPJfUdozNyCE3vpzhuku5s1qibibQjHnY68iciaIGB4zYw1Zbl05GQ3H4hadeLdBpQ9wEA/640?wx_fmt=gif "")  
  
**好看你就分享 有用就点个赞**  
  
**支持「****安全圈」就点个三连吧！**  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/aBHpjnrGylgeVsVlL5y1RPJfUdozNyCE3vpzhuku5s1qibibQjHnY68iciaIGB4zYw1Zbl05GQ3H4hadeLdBpQ9wEA/640?wx_fmt=gif "")  
  
  
