#  新漏洞影响过去6年内所有英特尔处理器   
原创 铸盾安全  河南等级保护测评   2025-05-17 16:00  
  
英特尔处理器中新发现的一类漏洞称为分支预测器竞争条件 (BPRC)，它允许攻击者系统地从共享同一硬件的其他用户的缓存和随机存取存储器 (RAM) 中提取敏感数据。  
  
该漏洞影响了过去六年发布的所有英特尔处理器（包括消费设备和云服务器基础设施中的处理器），利用了旨在加速计算性能的推测执行技术。  
  
苏黎世联邦理工学院计算机安全组 (COMSEC) 的研究人员证明，恶意行为者可以利用 BPRC 绕过处理器级别的特权屏障，以超过每秒 5,000 字节的速度实现未经授权的内存内容读取。  
  
这一缺陷对多租户云环境构成了严重风险，因为共享硬件资源会增加跨用户数据泄露的可能性。  
## 推测执行及其固有的安全权衡  
  
现代处理器采用推测执行来预测和预先计算可能的指令，从而减少程序执行的延迟。  
  
通过预测代码执行路径中的分支（例如条件语句），CPU 即使在从速度较慢的内存系统提取数据导致延迟的情况下也能保持计算吞吐量。然而，这种性能优化会创建攻击者可以利用的侧信道。  
  
苏黎世联邦理工学院 COMSEC 负责人 Kaveh Razavi指出，投机技术在用户上下文切换期间的权限检查中引入了时间间隙，“从根本上破坏了数据安全”。  
  
BPRC 漏洞遵循了Spectre (2017)、Meltdown (2017) 和 Retbleed (2022)等早期漏洞的模式，这些漏洞都利用推测执行来访问受保护的内存区域。这些反复出现的问题凸显了 CPU 架构在速度和安全性之间平衡方面的系统性缺陷。  
  
BPRC 漏洞源于对 Retbleed 补丁残留影响的调查。Razavi 团队的前博士生 Johannes Wikner 检测到，无论英特尔采取何种 Retbleed 缓解措施，异常缓存信号仍然存在。  
  
BPRC 研究的首席分析师 Sandro Rüegge 将这些信号追溯到权限转换期间发生的纳秒级竞争条件。  
  
当处理器在用户或进程之间切换时，它会暂时暂停推测执行以更新特权权限。然而，BPRC 暴露出一个关键缺陷：权限更新比推测指令预计算滞后几纳秒。  
  
攻击者可以在此窗口期间注入触发推测执行的代码，导致 CPU 错误地应用过时的权限。这会导致未经授权访问为高权限用户或进程保留的内存区域。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/sNicKB84ZxoHu8SD9RfmQkfrAYBSQQFEjT9ERtuG7BrAApg1LSdsSTmAicBLK2WhaEBvvWN6xTHoTuMicRQc7NGFw/640?wx_fmt=jpeg&from=appmsg "")  
  
通过重复此类攻击，攻击者可以连续提取内存内容。Rüegge 的实验表明，单个攻击周期只能检索一个字节，但快速迭代可以达到每秒 5,000 多个字节——足以在几分钟内窃取加密密钥或身份验证令牌等敏感数据。  
  
由于依赖共享硬件，云服务提供商面临着更高的风险。在同一物理服务器上运行的虚拟机 (VM) 或容器通常共享 CPU 资源，这为跨租户攻击创造了机会。  
  
恶意行为者可以部署受感染的虚拟机来从同地虚拟机收集数据，从而绕过虚拟化层安全措施。  
  
使用受影响的英特尔至强处理器的企业数据中心和公共云平台尤其容易受到攻击。攻击媒介已从传统服务器扩展到边缘计算节点和物联网设备，并利用英特尔的凌动 (Atom) 或酷睿 (Core) 系列芯片。  
  
英特尔于 2024 年底发布了微代码更新以解决 BPRC 问题，需要通过 BIOS 或操作系统补丁进行部署。  
  
然而，拉扎维强调，这种修复只是权宜之计：“推测技术中新发现的一系列漏洞表明存在根本的架构缺陷”。  
  
每个补丁都会带来性能开销，从而削弱推测执行旨在提供的速度优势。  
  
对于用户来说，安装最新的Windows、Linux或固件更新仍然至关重要。云提供商必须确保虚拟机管理程序和主机系统及时应用这些补丁。  
  
然而，与 Spectre 和 Meltdown 一样，彻底缓解可能需要重新设计硬件，而行业对传统 x86 架构的依赖使前景变得复杂。  
  
BPRC 强调处理器架构范式转变的必要性。学术界和行业团体正在探索替代方案，例如顺序执行（牺牲部分性能来换取确定性安全性）以及硬件强制隔离机制，例如英特尔的软件保护扩展 (SGX)。然而，此类设计的广泛采用仍需数年时间。  
  
在此之前，各组织必须优先考虑漏洞监控和分层防御。定期审核固件和微代码，并结合针对缓存异常进行调整的入侵检测系统，可以降低风险。  
  
对于高风险环境，将关键工作负载迁移到非英特尔平台虽然对许多人来说不切实际，但可能有必要。  
  
正如 Razavi 总结的那样：“性能优化与安全之间的军备竞赛正在升级。如果不进行架构彻底改革，我们将继续一个补丁一个补丁地应对推测执行缺陷。”  
  
